---
// Welcome to Astro! Everything between these triple-dash code fences
// is your "component frontmatter". It never runs in the browser.
console.log('This runs in your terminal, not the browser!');

import MainLayout from "../layouts/main-layout.astro";
import {Section} from '../components/Section';
import {HeroText} from '../components/HeroText';
import { WhyUs } from "../components/WhyUs";
import "../styles/global.css";
import { Form } from "../components/Form";
import { SectionIntro } from "../components/SectionIntro";
// import { Reviews } from "../components/Reviews";
import { Circle } from "../components/Circle";
import { TrustIcon } from "../utils/svgComponents";
// import { BrandCloud } from "../components/BrandCloud";


import heroImage from '/golf.png';
import bgCar from '/bgCar.jpeg';
import { Footer } from "../components/Footer";
import { BrandCloud } from "../components/BrandCloud";
---

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger)
  const sections = gsap.utils.toArray<HTMLElement>(".section");
  console.log(sections);
        // const menuItems = Array.from(document.querySelectorAll('.menu__item'));
        // const sectionsMap = new Map();

        // sections.forEach((section, index) => sectionsMap.set(section, menuItems[index]));

        // this._sectionTriggers = sections.map((section, i) => {
        //     const scrollTrigger = ScrollTrigger.create({
        //         trigger: section,
        //         start: "top center",
        //         onEnter: () => this._Header.setActiveItem(sectionsMap.get(sections[i])),
        //         onLeaveBack: () => this._Header.setActiveItem(sectionsMap.get(sections[i - 1])),
        //     });
        //     return scrollTrigger;
        // });

  // import { gsap } from "gsap";
  // import { ScrollTrigger } from "gsap/ScrollTrigger";

  // gsap.registerPlugin(ScrollTrigger);

  // const sections = gsap.utils.toArray<HTMLElement>(".section");
    console.log("sections",sections);
  sections.forEach((panel) => {
    ScrollTrigger.create({
      scroller: "main",
      trigger: panel,
      snap: 1 / (sections.length - 1),
      start: "top top", 
      pin: true, 
      pinSpacing:false,
      markers: true
    });
  });
</script>

<!-- snap-y snap-mandatory overflow-y-scroll -->
<MainLayout title="Vehicle Sourcing/Purchasing/Cover" classes="font-inter max-h-[100dvh] mt-headerHeight ">

  <Section className="section relative" justify="evenly" height="full">

    <div class="h-full grid grid-cols-1 md:grid-cols-12 grid-flow-row auto-rows-max ">
      <Circle className=""/>

      <HeroText className="row-start-2 xs-v:row-start-1 lg:row-start-2 col-start-1 md:col-start-1 md:col-span-8 lg:col-span-7 xl:col-span-6 z-30"/>

      <div class="flex flex-col relative max-w-md sm-v:max-w-sm lg:max-w-3xl xs:ml-auto
        md:col-start-5 md:col-span-full 
        xs-v:row-star sm-v:row-start-11 row-start-12 xs:row-start-9 md:row-start-8 lg:row-start-6">
        <img src={heroImage} class=" -scale-x-100" alt="Three BMW cars" />
      </div>

      <TrustIcon className="sm-v:hidden h-16 w-44 p-1 row-start-15 md:row-end-14 lg:row-end-13 md:col-start-2 lg:col-start-1 z-20" />

    </div>
  </Section>

  <Section className="section relative" variant="gray" justify="center" height="full">
    <div class="h-full grid grid-cols-1 gap-6 grid-flow-row auto-rows-max">
      <SectionIntro 
        title="How It Works"
        subtitle="3 Easy Steps"
        tagline="Let us take the hassle out of buying a car"
        className=" col-span-full"
        taglineClasses="xxs-v:hidden"
      />
      <WhyUs className="  col-span-full" client:only />
    </div>
  </Section>

  <Section className="section relative " height="full" variant="dark" client:only>
    <!-- <div class="relative h-full grid grid-cols-1 grid-rows-16 md:grid-cols-12"> -->

      <div class="absolute inset-0 overflow-hidden">
        <img src={bgCar} alt="Front-facing view of a car in the darkness" class="hidden md:flex xs:backdrop-brightness-10 absolute inset-0 -scale-x-100  ">
        <div class="absolute inset-0 bg-dark  "></div>
      </div>

      <div class="wrapper relative h-full grid grid-cols-1 grid-rows-16 md:grid-cols-12h-full lg:w-1/2 md:ml-auto">
        <SectionIntro 
          title="Find the Perfect Car"
          subtitle="Contact Us Today"
          variant="dark"
          className="row-start-1 w-full z-40"
          tagline="Let our team know what you're looking for and we'll get right on it!"
          taglineClasses="xxs-v:hidden"
          />   
        <Form className="row-start-5 xs-v:row-start-3 mt-4" client:only/>
        <BrandCloud className="xxs-v:hidden" />

      </div>
    </div>

  </Section>
  <!-- <Section variant="dark" height="full">
    <SectionIntro 
      title="How It Works"
      subtitle="WAKEY WINES"
      tagline="Buying a car should be something you enjoy"
      variant="dark"
    />  
    <WhyUs className="h-full" client:only />
  </Section>
  <Section height="full">
    <SectionIntro 
      title="Mange Tout Rodders"
      subtitle="ORIGINAL FAKE"
    />    
    <Reviews client:only/>
  </Section> -->

  <Section variant="darker">
    <Footer />
  </Section>
</MainLayout>